<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Application Deployment in Apache Tomcat on GCE Using Ansible</title>
    <meta name="description" content="Think about a person who needs a cloud instance temporarily to deploy a web application to do tests frequently and throughout the time he deploys the applica...">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="/blog/2018/tomcat-gce-ansible-demo/">
    <link rel="alternate" type="application/rss+xml" title="LAHIRU SANDARUWAN PATHIRAGE" href="/feed.xml" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.3/angular-material.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cantarell|Oxygen+Mono" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.3/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.3/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.3/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.3/angular-messages.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-material/1.1.3/angular-material.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-material-icons/0.7.1/angular-material-icons.min.js"></script>


    <script>
        var ngModule = angular.module('ngModule', ['ngAria', 'ngAnimate', 'ngMaterial', 'ngMessages', 'ngMdIcons']);

        ngModule.controller("ngController", function () {

        }).config(function($mdThemingProvider) {
            $mdThemingProvider.theme('customTheme')
                    .primaryPalette('red')
                    .accentPalette('red')
                    .warnPalette('red');
        });
    </script>
</head>


  <body ng-app="ngModule" ng-controller="ngController" ng-cloak>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>


  <div>
    <div class="site-wrapper">
      <div class="site-header">
        <div class="site-header-properties" layout="row">

  <div class="md-menu-properties" layout="column" flex="10">
    <div flex></div>

    <md-menu class="md-toolbar-tools">

      <md-button class="md-fab md-fab-top-left" aria-label="nav-menu" ng-click="$mdMenu.open()">
        <md-tooltip md-direction="right">Menu</md-tooltip>
        <md-icon>dehaze</md-icon>
      </md-button>

      <md-menu-content>
        <md-menu-item>
          <md-button href="/index.html">
            Home
          </md-button>
        </md-menu-item>

        
        <md-menu-item>
          <md-button href="/projects">
            Projects
          </md-button>
        </md-menu-item>
        
        <md-menu-item>
          <md-button href="/blog">
            Blog
          </md-button>
        </md-menu-item>
        
      </md-menu-content>

    </md-menu>

    <div flex></div>
  </div>

  <div flex="85">
    <md-tooltip>Home</md-tooltip>
    <div class="site-header-text">
      <a href="/index.html">
        <h1>
          LAHIRU SANDARUWAN PATHIRAGE
        </h1>
        <div class="site-description">
          SOFTWARE ENGINEER - LINUX ENTHUSIAST - OPEN SOURCE CONTRIBUTOR
        </div>
      </a>
    </div>
  </div>

  <div>
    <div>
      <ul class="social">
  <li><a href="http://github.com/lpsandaruwan" target="_blank">
    <span class="icon icon--github"><?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 17.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Github" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve">
<g>
	<circle id="github-back" fill="#262626" cx="64" cy="64" r="64"/>
	<g id="github-github">
		<path fill-rule="evenodd" clip-rule="evenodd" fill="#FFFFFF" d="M64,29.0449c-19.791,0-35.8398,16.0449-35.8398,35.8399
			c0,15.8349,10.2695,29.2695,24.5097,34.0088c1.791,0.331,2.4492-0.7784,2.4492-1.7247c0-0.8544-0.0332-3.6777-0.0488-6.6728
			c-9.9707,2.168-12.0752-4.2285-12.0752-4.2285c-1.6299-4.1426-3.9795-5.2451-3.9795-5.2451
			c-3.2519-2.2237,0.2456-2.1778,0.2456-2.1778c3.5982,0.253,5.4937,3.6953,5.4937,3.6953
			c3.1963,5.4776,8.3847,3.8936,10.4297,2.9776c0.3222-2.3164,1.2509-3.8975,2.2754-4.793
			c-7.96-0.9053-16.3291-3.9785-16.3291-17.7119c0-3.9126,1.4004-7.1104,3.6933-9.6196c-0.3721-0.9034-1.5996-4.5484,0.3477-9.4854
			c0,0,3.0088-0.9624,9.8574,3.6743c2.8594-0.7939,5.9258-1.1924,8.9707-1.206c3.0459,0.0136,6.1143,0.4121,8.9785,1.206
			c6.8408-4.6367,9.8467-3.6743,9.8467-3.6743c1.9502,4.937,0.7236,8.582,0.3516,9.4854c2.2978,2.5092,3.6884,5.707,3.6884,9.6196
			c0,13.7666-8.3847,16.7959-16.3652,17.6846c1.2852,1.1113,2.4297,3.2929,2.4297,6.6367c0,4.7949-0.0401,8.6543-0.0401,9.8349
			c0,0.9541,0.6456,2.0713,2.4629,1.7198c14.2315-4.7442,24.4883-18.1739,24.4883-34.0039
			C99.8408,45.0898,83.7939,29.0449,64,29.0449z"/>
		<path fill="#FFFFFF" d="M41.7354,80.5029c-0.0791,0.1787-0.3594,0.2315-0.6153,0.1104c-0.2597-0.1172-0.4057-0.3604-0.3213-0.5391
			c0.0772-0.1836,0.3575-0.2344,0.6172-0.1113C41.6768,80.0801,41.8247,80.3242,41.7354,80.5029L41.7354,80.5029z M41.2939,80.1758"
			/>
		<path fill="#FFFFFF" d="M43.1865,82.123c-0.1709,0.1583-0.5049,0.084-0.7314-0.166c-0.2354-0.25-0.2788-0.584-0.1055-0.7461
			c0.1768-0.1562,0.5-0.083,0.7354,0.167C43.3193,81.6309,43.3652,81.9619,43.1865,82.123L43.1865,82.123z M42.8447,81.7559"/>
		<path fill="#FFFFFF" d="M44.5996,84.1865c-0.2197,0.1533-0.5791,0.0088-0.8008-0.3095c-0.2197-0.3184-0.2197-0.7012,0.0049-0.8545
			c0.2227-0.1524,0.5762-0.0147,0.8013,0.3017C44.8242,83.6475,44.8242,84.0303,44.5996,84.1865L44.5996,84.1865z M44.5996,84.1865"
			/>
		<path fill="#FFFFFF" d="M46.5356,86.1797c-0.1967,0.2178-0.6147,0.1592-0.9213-0.1367c-0.3135-0.2881-0.4004-0.6992-0.2041-0.916
			c0.2002-0.2168,0.6211-0.1553,0.9287,0.1386C46.6504,85.5537,46.7451,85.9668,46.5356,86.1797L46.5356,86.1797z M46.5356,86.1797"
			/>
		<path fill="#FFFFFF" d="M49.2061,87.3389c-0.087,0.2802-0.4893,0.4072-0.8956,0.2881c-0.4052-0.1231-0.6699-0.4512-0.5888-0.7344
			c0.084-0.2832,0.4892-0.4151,0.8984-0.2881C49.0254,86.7266,49.29,87.0527,49.2061,87.3389L49.2061,87.3389z M49.2061,87.3389"/>
		<path fill="#FFFFFF" d="M52.1396,87.5527c0.0098,0.2959-0.3339,0.5411-0.7602,0.5469c-0.4282,0.0098-0.7759-0.2305-0.7798-0.5215
			c0-0.2978,0.3359-0.54,0.7647-0.5478C51.79,87.0225,52.1396,87.2598,52.1396,87.5527L52.1396,87.5527z M52.1396,87.5527"/>
		<path fill="#FFFFFF" d="M54.8691,87.0889c0.0508,0.2881-0.2451,0.5849-0.6679,0.6631c-0.417,0.0761-0.8018-0.1016-0.8545-0.3877
			c-0.0518-0.2959,0.25-0.5918,0.6645-0.669C54.4355,86.623,54.8154,86.7959,54.8691,87.0889L54.8691,87.0889z M54.8691,87.0889"/>
	</g>
</g>
</svg>
</span>
    <md-tooltip md-direction="top">http://github.com/lpsandaruwan</md-tooltip>
</a>
</li>
  <li><a href="http://linkedin.com/in/lpsandaruwan" target="_blank">
    <span class="icon icon--linkedin"><?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 17.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Linkedin" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve">
<g>
	<circle id="linkedin-back" fill="#262626" cx="64" cy="64" r="64"/>
	<g id="linkedin-linkedin">
		<path fill="#FFFFFF" d="M29.0752,51.7471h14.8686V99.54H29.0752V51.7471z M36.5137,27.9893c4.7514,0,8.6084,3.8593,8.6084,8.6137
			c0,4.7554-3.857,8.6143-8.6084,8.6143c-4.7705,0-8.6172-3.8589-8.6172-8.6143C27.8965,31.8486,31.7432,27.9893,36.5137,27.9893"/>
		<path fill="#FFFFFF" d="M53.2622,51.7471H67.5v6.5337h0.2041c1.9805-3.7574,6.8272-7.7198,14.0537-7.7198
			c15.0391,0,17.8184,9.896,17.8184,22.7671V99.54H84.7246V76.2979c0-5.542-0.0957-12.6719-7.7187-12.6719
			c-7.7286,0-8.9082,6.04-8.9082,12.2754V99.54H53.2622V51.7471z"/>
	</g>
</g>
</svg>
</span>
    <md-tooltip md-direction="top">http://linkedin.com/in/lpsandaruwan</md-tooltip>
</a></li>
  <li><a href="http://twitter.com/lpsandaruwan" target="_blank">
    <span class="icon icon--twitter"><?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 17.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" id="Twitter" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve">
<g>
	<circle id="twitter-back" fill="#262626" cx="64" cy="64" r="64"/>
	<path id="twitter-twitter" fill="#FFFFFF" d="M99.8398,41.7695c-2.6367,1.17-5.4707,1.96-8.4462,2.3155
		c3.0351-1.8204,5.3681-4.7022,6.4658-8.1363c-2.8408,1.6851-5.9883,2.9097-9.3379,3.5689
		c-2.6826-2.8584-6.5049-4.6436-10.7344-4.6436c-8.123,0-14.7065,6.584-14.7065,14.7051c0,1.1533,0.1303,2.2754,0.3808,3.3516
		c-12.2221-0.6133-23.0581-6.4678-30.311-15.3648c-1.2661,2.1714-1.9912,4.6978-1.9912,7.3931c0,5.1015,2.5962,9.6025,6.542,12.2397
		c-2.4107-0.0757-4.6783-0.7378-6.6607-1.8393c-0.0014,0.0615-0.0014,0.123-0.0014,0.1855c0,7.125,5.0693,13.0684,11.7968,14.4199
		c-1.2343,0.336-2.5337,0.5157-3.8745,0.5157c-0.9477,0-1.8691-0.0928-2.7671-0.2637c1.8716,5.8418,7.3023,10.0937,13.7378,10.2119
		c-5.0332,3.9453-11.374,6.2959-18.2646,6.2959c-1.187,0-2.357-0.0693-3.5073-0.2051c6.5083,4.1729,14.2377,6.6065,22.5429,6.6065
		c27.0498,0,41.8418-22.4082,41.8418-41.8418c0-0.6377-0.0146-1.2715-0.0429-1.9024C95.375,47.3086,97.8691,44.7188,99.8398,41.7695
		z"/>
</g>
</svg>
</span>
    <md-tooltip md-direction="top">http://twitter.com/lpsandaruwan</md-tooltip>
</a>
</li>
  <li><a href="/feed.xml" target="_blank">
    <span class="icon icon--feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-3.374 17c-.897 0-1.626-.727-1.626-1.624s.729-1.624 1.626-1.624 1.626.727 1.626 1.624-.729 1.624-1.626 1.624zm3.885 0c-.03-3.022-2.485-5.474-5.511-5.504v-2.406c4.361.03 7.889 3.555 7.92 7.91h-2.409zm4.081 0c-.016-5.297-4.303-9.571-9.592-9.594v-2.406c6.623.023 11.985 5.384 12 12h-2.408z"/></svg></span>
    <md-tooltip md-direction="top">feed</md-tooltip>
</a></li>
</ul>
    </div>
  </div>
</div>

      </div>

      <div class="site-content">
        <div class="inner-body">
          <div class="body-content">
            <article role="article" class="post">

  <div>
    <header class="post-header">
      <h1>Application Deployment in Apache Tomcat on GCE Using Ansible</h1>
      <h4>Orchestrating Apache tomcat Tomcat deployments in Google Cloud Platform using Ansible.</h4>
      <p>
        <span class="strong">Tags</span>: tomcat, gce, ansible, configuration-management
      </p>
      <p class="post-meta">Mar 1, 2018 • Lahiru Pathirage</p>
    </header>

    <div class="bottom-padding-10"></div>

    <div class="post-content">
      <p>Think about a person who needs a cloud instance temporarily to deploy a web application to do tests frequently and throughout the time he deploys the application,
use it for a while and then deletes the instance to save the cost.
Or someone needs to create a cluster, thus he needs to instantiate several cloud servers at once,
install dependencies and deploy the application on each server. Doing these tasks by hand costs much effort and it is inefficient.
The way to make such scenarios easier, efficient and effective is making a reusable structure which does these repetitive tasks when we invoke it.
For that purpose, we use configuration management.</p>

<p><img src="/images/posts/gce-tomcat-ansible/cm_showoff.png" alt="cm_what_happens" /></p>

<p>This tutorial is about a such scenario, to splash the easiness of using a reusable code base when deploying an application,
using <strong>Ansible</strong>(a radical and impressive configuration management tool with its capabilities and ease of use compared to other tools),
<strong>Google cloud platform</strong>(future potential cloud services with a good pricing model) and <strong>Apache Tomcat</strong>
(one of the most popular web servers in the Java community). For this purpose, we are going to use the <a href="https://github.com/lpsandaruwan/gce-tomcat-ansible-demo">gce-tomcat-ansible-demo</a> repository,
 a concatenation of Ansible playbooks(the reusable code base) implemented by me to reflect this task.
  Running this will create a Google compute engine in a given Google cloud platform project, install java,
   configure an Apache Tomcat server and will deploy a war file according to given metadata.
   (To understand playbooks knowing Ansible basics is more than enough. Refer <a href="http://docs.ansible.com/ansible/latest/intro_getting_started.html">Ansible documentation</a>)</p>

<p><img src="/images/posts/gce-tomcat-ansible/playbook_flow.png" alt="playbook_flow" /></p>

<p><br /></p>
<h2 id="getting-started">Getting started</h2>

<p>To run the playbook you need to have <strong>a Google cloud platform account</strong>, <strong>a Google cloud platform project</strong> and <strong>a service account</strong>
to manipulate Google cloud project with appropriate roles and permission and <strong>an Ansible running machine</strong>.</p>

<p>There are several ways to install Ansible but here let’s install it using python pip package manager since the installation
is not going to depend on which operating system you use. But first make sure Python version 2,
Python development and Python pip(most probably python-dev and python-pip respectively,
refer <a href="https://packaging.python.org/guides/installing-using-linux-tools/#installing-pip-setuptools-wheel-with-linux-package-managers">installing pip with package managers for more information</a>) packages have been installed on the machine that you are
 going to install Ansible. To make sure, try running the command below.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>pip list</code></pre></figure>

<p><img src="/images/posts/gce-tomcat-ansible/pip_list.png" alt="pip_list" /></p>

<p>And then clone the repository <a href="https://github.com/lpsandaruwan/gce-tomcat-ansible-demo">gce-tomcat-ansible-demo</a>, which contains playbooks to create a Google compute engine instance,
 install Java, configure a Apache Tomcat server and deploy a given war file on the configured application server.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>git clone https://github.com/lpsandaruwan/gce-tomcat-ansible-demo.git</code></pre></figure>

<p>Then change the current working directory into the cloned repository.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="nb">cd</span> gce-tomcat-ansible-demo</code></pre></figure>

<p>Now use the <code>requirements.txt</code> to install appropriate Python pip package versions which this playbook has been written and tested for.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>pip install -r requirements.txt</code></pre></figure>

<p>This will install ansible and apache-libcloud(a fine interface to deal with popular cloud services)
Python packages which we are going to use for manipulating Google cloud project.</p>

<p>Make sure that you have a working Google cloud platform project(if not refer <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">creating and manage projects</a>),
and a service account assigned to it(do not use the default service account since it has full permission over the project,
refer <a href="https://cloud.google.com/compute/docs/access/service-accounts">service accounts</a> for more information) and then obtain the project ID,
private JSON keyfile(you can obtain the JSON key file when creating a new service account,
if not refer <a href="https://cloud.google.com/storage/docs/authentication#service-account-credentials">service account credentials</a>) and the service account email from them.
Now we have to configure Ansible running machine to access the GCP project.
Here Let’s use Google cloud SDK to make things easier(refer <a href="https://cloud.google.com/sdk/downloads#versioned">install Google cloud SDK</a>).
After installing the SDK run the below command to initialize.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>gcloud init</code></pre></figure>

<p><img src="/images/posts/gce-tomcat-ansible/gcloud_init.png" alt="gcloud_init" /></p>

<p>And it will direct you to the web page in your browser. From there allow the access to the SDK.
 Now in the terminal select the appropriate project ID. After that you should be able to run playbooks on the appropriate project and manipulate it.
  If you run into a permission problem connecting the instance configure SSH authentication using cloud SDK tools by running the command below.
  (refer <a href="https://cloud.google.com/sdk/gcloud/reference/compute/config-ssh">gcloud compute config-ssh</a>)</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>gcloud compute config-ssh</code></pre></figure>

<p><br /></p>

<h2 id="play-it">Play it</h2>

<p>Now configure the file <code>gce-vars/authentication</code> and update the obtained metadata from GCP project and service account in playbook.</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span></span><span class="l l-Scalar l-Scalar-Plain">project_id</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">“project-id-193706”</span>
<span class="l l-Scalar l-Scalar-Plain">credentials_file</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">“/path/to/private/json/key/file”</span>
<span class="l l-Scalar l-Scalar-Plain">service_account_email</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">“tomcat-ansible-demo@service-account-193706.iam.gserviceaccount.com”</span></code></pre></figure>

<p>After that change instance metadata in <code>gce-vars/instance</code> as you need. Here,
we are going to add firewall rules to allow HTTP traffic on 8080 ports for Apache Tomcat server</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span></span><span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tomcat-ansible-demo</span>
<span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">f1-micro</span>
<span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">debian-9</span>
<span class="l l-Scalar l-Scalar-Plain">zone</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">europe-west1-b</span>
<span class="l l-Scalar l-Scalar-Plain">allowed_ports_tcp</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">tcp:8080</span>
<span class="l l-Scalar l-Scalar-Plain">allowed_ports_udp</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">udp:8080</span></code></pre></figure>

<p>Then set the <code>ANSIBLE_HOSTS</code> environment variable required by Ansible for SSH interactions.
To do that simply put hostnames in <code>hosts</code> file and import it as below.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span><span class="nb">export</span> <span class="nv">ANSIBLE_HOSTS</span><span class="o">=</span>hosts</code></pre></figure>

<p>Now you should be able to run this project. Simply run the main playbook.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>ansible-playbook run.ym</code></pre></figure>

<p>Final output will be as below. And after a successful run you will have your application deployed in an
Apache Tomcat server on a Google compute engine instance.</p>

<p><img src="/images/posts/gce-tomcat-ansible/final.png" alt="final" />
<img src="/images/posts/gce-tomcat-ansible/web.png" alt="web" />
<br /></p>

<h2 id="appendix">Appendix</h2>

<p>(If you wish to change Java version, Tomcat version etc.
configure main.yml in defaults directory in roles. They contain configuration variables with lower priorities.)</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text"><span></span>gce-tomcat-ansible-demo
|------gce_vars				# variables related to Google cloud platform
|	|	authentication		# Google project and service account related metadata
|	|	instance		# GCE instance related metadata
|
|-------roles
|	|-------java				# role to install Java
|	|	|-------defaults
|	|	|	|	main.yml	# default variables for java role
|	|	|
|	|	|-------tasks
|	|	|	|	main.yml	# tasks to download and install Java
|	|
|	|-------tomcat
|	|	|-------defaults
|	|	|	|	main.yml	# default variables for tomcat role
|	|	|
|	|	|-------files
|	|	|	|	tomcat-users.xml	# set tomcat manager credentials
|	|	|
|	|	|-------tasks
|	|	|	|	main.yml	# tasks to download and configure tomcat
|	|
|	|-------tomcat-deploy
|	|	|-------defaults
|	|	|	|	main.yml	# default variables for tomcat-deploy role
|	|	|
|	|	|-------tasks
|	|	|	|	main.yml	# tasks to deploy the given war file
|
|	hosts					# ansible hosts
|	bootstrap-instance.yml			# playbook to initiate google cloud instance
|	deploy-war.yml				# playbook to deploy war file
|	install-java.yml			# playbook to install Java
|	install-tomcat.yml			# playbook to install Apache Tomcat
|	run.yml					# main playbook to run</code></pre></figure>

<p><br />
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">gce-tomcat-ansible-demo post</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://lahiru.site/blog/2018/tomcat-gce-ansible-demo/" property="cc:attributionName" rel="cc:attributionURL">Lahiru Pathirage</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://github.com/lpsandaruwan/gce-tomcat-ansible-demo" rel="dct:source">https://github.com/lpsandaruwan/gce-tomcat-ansible-demo</a>.</p>

    </div>

    
<hr>

<aside id="comments" class="disqus">
  <div class="container">
    <h3><i class="icon icon-comments-o"></i> Comments</h3>
    <div id="disqus_thread"></div>
    <script>
      var disqus_config = function() {
        this.page.url = '';
        this.page.identifier = '/blog/2018/tomcat-gce-ansible-demo';
      };
      (function() {
        var d = document,
        s = d.createElement('script');
        s.src = '//lpsandaruwan.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</aside>

  </div>

</article>

          </div>
        </div>

        <br>
        <div>
  <div class="footer-contents">
    <ul layout-xs="column" layout="row">
      <li class="footer-section" flex-gt-xs="45">
        <br>
        <div class="header-background">
          <h4>ABOUT ME</h4>
        </div>

        <p>
          I am a software developer from Colombo, Sri Lanka who believes in following good design and good engineering aspects when developing software thus they play the major role when bringing high-quality software products into reality. I have been working professionally in software engineering since 2015.
        </p>

        <br>
      </li>

      <li flex-gt-xs="10"></li>

      <li class="footer-section" flex-gt-xs="45">
        <br>
        <div class="header-background">
          <h4>CONTACT ME</h4>
        </div>

        <div>
          <p>
            <a href="mailto:lpsandaruwan@gmail.com">
              <md-icon>contact_mail</md-icon>
              &nbsp;lpsandaruwan@gmail.com
            </a>
          </p>
        </div>

        <div>
          <p>
            <md-icon>group_add</md-icon>
            &nbsp;telegram: lpsandaruwan
          </p>
        </div>
        <br>
      </li>
    </ul>
    <div class="footer-bar">
      <p>© Copyright 2017 Lahiru Sandaruwan Pathirage. Powered by Jekyll. All Rights Reserved.</p>
    </div>
  </div>
</div>

      </div>

    </div>


  </div>
  </body>
</html>
